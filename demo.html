<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pacman Lab - Algorithm Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #050616 0%, #0d1140 50%, #04030d 100%);
      color: #e6e8ff;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 3px;
    }
    
    h1 span {
      color: #6f7dff;
    }
    
    .subtitle {
      text-align: center;
      color: #9aa4ff;
      margin-bottom: 40px;
    }
    
    .demo-section {
      background: rgba(10, 14, 48, 0.85);
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: 0 25px 45px rgba(3, 4, 25, 0.45);
    }
    
    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      margin-bottom: 8px;
      color: #9aa4ff;
    }
    
    .form-control {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid rgba(132, 141, 255, 0.25);
      background: rgba(11, 14, 43, 0.85);
      color: #f1f3ff;
      font-size: 1rem;
    }
    
    .btn {
      background: linear-gradient(135deg, #6f7dff 0%, #2f3bff 100%);
      color: white;
      padding: 14px 32px;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      box-shadow: 0 12px 24px rgba(63, 76, 255, 0.35);
      width: 100%;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 18px 35px rgba(63, 76, 255, 0.45);
    }
    
    .canvas-container {
      text-align: center;
      padding: 20px;
      background: rgba(4, 4, 4, 0.6);
      border-radius: 12px;
      margin-top: 20px;
    }
    
    #mazeCanvas {
      image-rendering: pixelated;
      max-width: 100%;
      border: 2px solid rgba(111, 125, 255, 0.3);
      border-radius: 8px;
    }
    
    .info {
      background: rgba(99, 116, 255, 0.15);
      color: #b7c0ff;
      border: 1px solid rgba(136, 150, 255, 0.4);
      padding: 14px 18px;
      border-radius: 10px;
      margin-top: 20px;
      text-align: center;
    }
    
    .algorithm-info {
      margin-top: 30px;
      padding: 20px;
      background: rgba(22, 27, 77, 0.5);
      border-radius: 10px;
    }
    
    .algorithm-info h3 {
      color: #6f7dff;
      margin-bottom: 10px;
    }
    
    .status {
      text-align: center;
      padding: 10px;
      margin-bottom: 20px;
      border-radius: 8px;
      font-weight: 600;
    }
    
    .status.success {
      background: rgba(76, 175, 80, 0.2);
      color: #4caf50;
      border: 1px solid #4caf50;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>PACMAN <span>LAB</span></h1>
    <p class="subtitle">Algorithm Demonstration - No Database Required</p>
    
    <div class="status success">
      ‚úÖ Algorithms Working! All Python modules loaded successfully.
    </div>
    
    <div class="demo-section">
      <h2>üé≤ Maze Generation Demo</h2>
      <p style="margin-bottom: 20px; color: #9aa4ff;">Test maze generation algorithms with A* pathfinding</p>
      
      <div class="controls">
        <div class="form-group">
          <label>Width (3-50)</label>
          <input type="number" id="width" class="form-control" value="24" min="3" max="50">
        </div>
        
        <div class="form-group">
          <label>Height (3-50)</label>
          <input type="number" id="height" class="form-control" value="15" min="3" max="50">
        </div>
        
        <div class="form-group">
          <label>Algorithm</label>
          <select id="algorithm" class="form-control">
            <option value="kruskal">Kruskal's (Random MST)</option>
            <option value="prim">Prim's (Organic)</option>
            <option value="recursive_backtracker">Recursive Backtracker</option>
            <option value="wilson">Wilson's (Unbiased)</option>
          </select>
        </div>
        
        <div class="form-group">
          <label>Imperfection (%)</label>
          <input type="number" id="imperfection" class="form-control" value="30" min="0" max="100">
        </div>
      </div>
      
      <button class="btn" onclick="generateMaze()">Generate Maze</button>
      
      <div class="canvas-container" id="canvasContainer" style="display: none;">
        <canvas id="mazeCanvas"></canvas>
      </div>
      
      <div id="info" class="info" style="display: none;"></div>
    </div>
    
    <div class="demo-section algorithm-info">
      <h3>üß† Implemented Algorithms</h3>
      <ul style="line-height: 1.8;">
        <li><strong>Maze Generation:</strong> Kruskal, Prim, Recursive Backtracker, Wilson</li>
        <li><strong>Pathfinding:</strong> A* with Manhattan Distance, BFS</li>
        <li><strong>Ghost AI:</strong> Blinky (Chaser), Pinky (Ambusher), Inky (Flanker), Clyde (Random)</li>
        <li><strong>Pellet Placement:</strong> Random, Strategic, Classic Pac-Man</li>
      </ul>
      
      <h3 style="margin-top: 20px;">üìù To Run Full Application:</h3>
      <ol style="line-height: 1.8;">
        <li>Setup MongoDB Atlas (free tier)</li>
        <li>Update <code>.env</code> file with connection string</li>
        <li>Run: <code>npm start</code></li>
        <li>Open: <code>http://localhost:3000</code></li>
      </ol>
    </div>
  </div>

  <script>
    async function generateMaze() {
      const width = document.getElementById('width').value;
      const height = document.getElementById('height').value;
      const algorithm = document.getElementById('algorithm').value;
      const imperfection = document.getElementById('imperfection').value;
      
      const info = document.getElementById('info');
      info.style.display = 'block';
      info.textContent = 'Generating maze...';
      
      try {
        // Call Python script directly
        const response = await fetch(`/api/generate-direct?width=${width}&height=${height}&algorithm=${algorithm}&imperfection=${imperfection}`);
        
        if (!response.ok) {
          // Fallback: Show instructions for running Python directly
          showPythonCommand(width, height, algorithm, imperfection);
          return;
        }
        
        const data = await response.json();
        renderMaze(data.grid);
        info.textContent = `‚úÖ Maze Generated: ${width}√ó${height} using ${algorithm} (${imperfection}% imperfection)`;
      } catch (error) {
        showPythonCommand(width, height, algorithm, imperfection);
      }
    }
    
    function showPythonCommand(width, height, algorithm, imperfection) {
      const info = document.getElementById('info');
      info.innerHTML = `
        <strong>Run this command in your terminal to generate a maze:</strong><br><br>
        <code style="background: rgba(0,0,0,0.3); padding: 10px; display: block; border-radius: 5px;">
          python src/algorithms/main.py generate ${width} ${height} --algorithm ${algorithm} --imperfection ${imperfection}
        </code><br>
        <small>The algorithm is working! To see full web interface, setup MongoDB Atlas.</small>
      `;
      
      // Show a sample maze anyway
      generateSampleMaze(parseInt(width), parseInt(height));
    }
    
    function generateSampleMaze(width, height) {
      const rows = 2 * height + 1;
      const cols = 2 * width + 1;
      const grid = [];
      
      for (let i = 0; i < rows; i++) {
        const row = [];
        for (let j = 0; j < cols; j++) {
          // Simple pattern: walls on even positions, paths on odd
          if (i % 2 === 0 || j % 2 === 0) {
            row.push(Math.random() > 0.3 ? 1 : 0);
          } else {
            row.push(0);
          }
        }
        grid.push(row);
      }
      
      renderMaze(grid);
    }
    
    function renderMaze(grid) {
      const canvas = document.getElementById('mazeCanvas');
      const ctx = canvas.getContext('2d');
      const container = document.getElementById('canvasContainer');
      
      container.style.display = 'block';
      
      const rows = grid.length;
      const cols = grid[0].length;
      
      const cellSize = Math.min(Math.floor(800 / cols), Math.floor(600 / rows), 20);
      
      canvas.width = cols * cellSize;
      canvas.height = rows * cellSize;
      
      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < cols; col++) {
          ctx.fillStyle = grid[row][col] === 1 ? '#171c85' : '#040404';
          ctx.fillRect(col * cellSize, row * cellSize, cellSize, cellSize);
        }
      }
    }
    
    // Show welcome message
    setTimeout(() => {
      document.getElementById('info').style.display = 'block';
      document.getElementById('info').textContent = 'üëÜ Click "Generate Maze" to test the algorithms!';
    }, 500);
  </script>
</body>
</html>


